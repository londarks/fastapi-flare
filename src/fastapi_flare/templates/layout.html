<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ title }}</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    {% include "_styles.html" %}
    {% block styles %}{% endblock %}
  </style>
</head>
<body>

{# ── HEADER ───────────────────────────────────────────────────────────────── #}
<header>
  <button class="sidebar-toggle" id="sidebarToggle" title="Toggle sidebar">
    <i class="fas fa-bars" id="sidebarToggleIcon"></i>
  </button>
  <div class="logo">
    <i class="fas fa-fire-flame-curved"></i>
    <span>{{ title }}</span>
    <span class="badge">MONITOR</span>
  </div>
  <div class="header-right">
    <div class="header-health" id="healthStatus">
      <div class="hh-item">
        <div class="health-dot unknown" id="hDotStorage"></div>
        <span class="hh-val" id="hValStorage">&#x2014;</span>
      </div>
      <div class="hh-sep"></div>
      <div class="hh-item">
        <div class="health-dot unknown" id="hDotWorker"></div>
        <span class="hh-val" id="hValWorker">&#x2014;</span>
      </div>
      <div class="hh-sep"></div>
      <div class="hh-item">
        <div class="health-dot unknown" id="hDotQueue"></div>
        <span class="hh-val" id="hValQueue">&#x2014;</span>
      </div>
    </div>
    {% block header_right %}{% endblock %}
    {% if current_user is defined %}
    <div class="profile-pill" id="profilePill">
      <div class="profile-avatar" id="profileAvatar">
        {% if current_user.picture %}
          <img src="{{ current_user.picture }}" alt=""
               onerror="this.parentElement.textContent='{{ (current_user.name or 'A')[0] | upper }}'" />
        {% else %}
          {{ (current_user.name or 'A')[0] | upper }}
        {% endif %}
      </div>
      <span class="profile-name">{{ current_user.name }}</span>
      <i class="fas fa-chevron-down profile-chevron"></i>
      <div class="profile-dropdown">
        <div class="profile-dd-header">
          <div class="profile-dd-name">{{ current_user.name }}</div>
          {% if current_user.email %}
          <div class="profile-dd-email">{{ current_user.email }}</div>
          {% endif %}
        </div>
        {% if logout_path %}
        <div class="profile-dd-sep"></div>
        <a href="{{ logout_path }}" class="profile-dd-item danger">
          <i class="fas fa-right-from-bracket"></i> Logout
        </a>
        {% endif %}
      </div>
    </div>
    {% endif %}
  </div>
</header>

{# ── SIDEBAR ──────────────────────────────────────────────────────────────── #}
<aside class="sidebar">
  <p class="sidebar-section-label">Navigation</p>
  <nav class="sidebar-nav">
    <a href="{{ requests_path }}" class="nav-item {% if active_tab == 'requests' %}active{% endif %}">
      <i class="fas fa-arrow-right-arrow-left"></i><span>Requests</span>
    </a>
    <a href="{{ errors_path }}" class="nav-item {% if active_tab == 'errors' %}active{% endif %}">
      <i class="fas fa-circle-exclamation"></i><span>Errors</span>
    </a>
    <a href="{{ storage_path }}" class="nav-item {% if active_tab == 'storage' %}active{% endif %}">
      <i class="fas fa-database"></i><span>Storage</span>
    </a>
    <a href="{{ settings_path }}" class="nav-item {% if active_tab == 'settings' %}active{% endif %}">
      <i class="fas fa-sliders"></i><span>Settings</span>
    </a>
  </nav>
  <div class="sidebar-footer">
    <i class="fas fa-fire-flame-curved"></i>
    <span>fastapi-flare</span>
  </div>
</aside>

{# ── MAIN ─────────────────────────────────────────────────────────────────── #}
<main>
  {% block content %}{% endblock %}
</main>

<div class="toast-container" id="toastContainer"></div>

{% block scripts %}{% endblock %}
{% include "_scripts_global.html" %}

</body>
</html>
